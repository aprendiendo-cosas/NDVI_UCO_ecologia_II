<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>guion_ndvi</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; --title-bar-height: 20px; }
.mac-os-11 { --title-bar-height: 28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); background-position: initial initial; background-repeat: initial initial; }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }
@media print { 
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-require-zoom-fix foreignObject { font-size: var(--mermaid-font-zoom); }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right-width: 1px; border-right-style: solid; border-right-color: rgb(221, 221, 221); background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; white-space: nowrap; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; background-position: inherit inherit; background-repeat: inherit inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; border: none !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-top-left-radius: 0px; border-top-right-radius: 0px; border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; border-width: 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; background-position: 0px 0px; background-repeat: initial initial; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right-width: 30px; border-right-style: solid; border-right-color: transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right-style: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right-style: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background-color: rgba(255, 255, 0, 0.4); background-position: initial initial; background-repeat: initial initial; }
@media print { 
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

/* open-sans-regular - latin-ext_latin */
  /* open-sans-italic - latin-ext_latin */
    /* open-sans-700 - latin-ext_latin */
    /* open-sans-700italic - latin-ext_latin */
  html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}

@media only screen and (min-width: 1400px) {
	#write {
		max-width: 1024px;
	}
}

@media only screen and (min-width: 1800px) {
	#write {
		max-width: 1200px;
	}
}

#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}

/*@media print {
    .typora-export h1,
    .typora-export h2 {
        border-bottom: none;
        padding-bottom: initial;
    }

    .typora-export h1::after,
    .typora-export h2::after {
        content: "";
        display: block;
        height: 100px;
        margin-top: -96px;
        border-top: 1px solid #eee;
    }
}*/

h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table th:first-child,
table td:first-child {
    margin-top: 0;
}
table th:last-child,
table td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

 :root {--mermaid-font-zoom:1em ;} 
</style>
</head>
<body class='typora-export'>
<div id='write'  class=''><h1><a name="guión-de-la-práctica-caracterización-de-cambios-temporales-en-el-funcionamiento-de-ecosistemas-mediterráneos-mediante-teledetección" class="md-header-anchor"></a><span>Guión de la práctica &quot;caracterización de cambios temporales en el funcionamiento de ecosistemas Mediterráneos mediante teledetección&quot;</span></h1><blockquote><ul><li><strong><em><span>Versión</span></em></strong><span>: v.2020-2021</span></li><li><strong><em><span>Asignatura (grado)</span></em></strong><span>: Ecología II (Biología)</span></li><li><strong><em><span>Autor</span></em></strong><span>: Curro Bonet-García (fjbonet@uco.es)</span></li><li><strong><em><span>Duración</span></em></strong><span>: 2,5 horas.</span></li></ul></blockquote><p>&nbsp;</p><h2><a name="objetivos" class="md-header-anchor"></a><span>Objetivos </span></h2><p><span>En esta práctica se plantéan los siguientes objetivos:</span></p><ul><li><p><span>Disciplinares: Están relacionados con competencias propias de la ecología.</span></p><ul><li><span>Mejorar nuestra comprensión de los conceptos de estructura y funcionamiento en un ecosistema forestal.</span></li><li><span>Conocer el concepto de serie temporal.</span></li><li><span>Relacionar los cambios en la estructura con los cambios en el funcionamiento de un ecosistema.</span></li><li><span>Aprender la utilidad de los índices de vegetación obtenidos mediante satélites para caracterizar la estructura y el funcionamiento de los ecosistemas.</span></li></ul></li><li><p><span>Instrumentales: Están relacionados con la adquisición de competencias en el manejo de herramientas potencialmente útiles en ecología y en otros ámbitos.</span></p><ul><li><span>Afianzar los conocimientos ya adquiridos sobre el manejo de SIG y de R.</span></li><li><span>Aprender a caracterizar cuantitativamente una serie temporal de una variable biofísica (índice de vegetación).</span></li><li><span>Aprender a manejar imágenes de satélite para caracterizar el funcionamiento de los ecosistemas.</span></li><li><span>Establecer relaciones entre datos tomados en campo y datos observados vía satélite.</span></li></ul></li></ul><p><span>Estos objetivos se abordarán usando como contexto espacial la finca de el Patriarca, donde ya se han realizado otras prácticas de esta asignatura. </span></p><p>&nbsp;</p><h2><a name="introducción-teledetección-y-ecología" class="md-header-anchor"></a><span>Introducción: teledetección y ecología</span></h2><p><span>El conjunto de prácticas denominadas &quot;caracterización ecológica del Patriarca&quot; nos permite aplicar una serie de técnicas que son útiles para conocer mejor la estructura (ej. densidad del bosque, diversidad, etc.) y el funcionamiento (ej. tasa de regeneración, descomposición, producción primaria, etc.) del sistema ecológico que hay en esa zona. La información recopilada durante estas prácticas es de gran interés para mejorar la forma en la que los humanos obtenemos servicios de dichos ecosistemas. </span></p><p><span>En esta práctica trabajaremos en un aspecto muy importante en los ecosistemas terrestres: la producción primaria. Cuantificaremos cómo se lleva a cabo el proceso de transformación de la materia inorgánica en orgánica a través de la fotosíntesis. Para ello usaremos imágenes procedentes de sensores alojados a bordo de satélites que orbitan alrededor de la Tierra. </span></p><p><span>Los satélites pueden detectar y cuantificar la actividad fotosintética porque son sensibles a las longitudes de onda que utilizan las plantas cuando para generar materia orgánica. Cuando una planta está viva y haciendo la fotosíntesis tiene una &quot;firma espectral&quot; determinada. Cuando está muerta o no hace la fotosíntesis tiene otra diferente. Esto se debe a que cuando están haciendo la fotosíntesis son capaces de absorber ciertas bandas del espectro electromagnético (concretamente el rojo). Teniendo en cuenta esto es posible construir índices que cuantifican cómo de intensa es la fotosíntesis en un lugar determinado y en un tiempo concreto. En esta práctica aplicaremos uno de los índices más comunmente utilizados, el NDVI: </span><a href='https://en.wikipedia.org/wiki/Normalized_difference_vegetation_index'><span>Normalized difference vegetation index.</span></a><span> En concreto en esta ocasión usaremos datos suministrados por un satélite llamado Landsat 7, que pasa por cada punto de la Tierra cada 16 días. Los sensores que tiene este satélite permiten calcular el NDVI en cada pasada. </span><a href='https://landsat.gsfc.nasa.gov/landsat-7/ '><span>Landsat 7</span></a><span> se lanzó en 1999 y sigue enviando información en la actualidad. La resolución espacial de esta información es de 30 metros. </span></p><p><span>De manera más concreta, durante esta sesión haremos lo siguiente:</span></p><ul><li><span>Generar una gráfica que muestre los cambios del NDVI (y por tanto de la actividad fotosintética) a lo largo del tiempo (desde 1999 a 2018) en cada píxel de 30 m de lado.</span></li><li><span>Cuantificar la tendencia de la serie de NDVI observada la zona de estudio. Analizaremos si cada punto de 30x30 m ha experimentado en el periodo analizado, un aumento de NDVI, un descenso o si se ha mantenido estable. </span></li><li><span>Obtener un mapa que muestre el NDVI promedio de cada píxel en la zona de estudio. Relacionaremos este valor promedio de NDVI con los datos de densidad del bosque medidos en campo.</span></li></ul><p>&nbsp;</p><p><a href='https://github.com/aprendiendo-cosas/P_NDVI_UCO_ecologia_II/raw/main/presentaciones/teledeteccion.ppt'><span>Esta</span></a><span> presentación describe con más detalle los conceptos teóricos que sustentan esta práctica. Y la siguiente figura muestra el resumen de las tareas a abordar.</span></p><p>&nbsp;</p><p><img src="https://github.com/aprendiendo-cosas/P_NDVI_UCO_ecologia_II/raw/main/imagenes/resumen.png" referrerpolicy="no-referrer" alt="resumen"></p><p>&nbsp;</p><p>&nbsp;</p><h2><a name="secuencia-de-acciones-a-realizar" class="md-header-anchor"></a><span>Secuencia de acciones a realizar</span></h2><p><span>Para caracterizar la serie temporal de NDVI y para calcular el promedio de los máximos de NDVI daremos los pasos descritos en las siguientes secciones. Pero antes, es importante descargar la información de partida:</span></p><ul><li><a href='https://github.com/aprendiendo-cosas/P_NDVI_UCO_ecologia_II/raw/main/geoinfo/NDVI_maximo_anual.zip'><span>Imágenes de NDVI anuales (NDVI_maximo_anual.zip)</span></a><span>. Es un archivo zip. Descomprímelo en la carpeta en la que vayas a trabajar.</span></li><li><a href='https://github.com/aprendiendo-cosas/P_NDVI_UCO_ecologia_II/raw/main/geoinfo/patriarca.zip'><span>Delimitación del Patriarca (patriarca.zip)</span></a><span>. Es un fichero de formas poligonal que delimita la finca del Patriarca. Ponlo en la misma carpeta en la que has puesto el resto del material.</span></li></ul><h3><a name="caracterización-de-la-serie-temporal-de-ndvi" class="md-header-anchor"></a><span>Caracterización de la serie temporal de NDVI</span></h3><ul><li><p><span>(0) Este flujo de trabajo está también explicado en </span><a href='https://youtu.be/22dlKcNa_SI'><span>este</span></a><span> vídeo.</span></p></li><li><p><span>Ve copiando y pegando el código que aparece abajo en un archivo de R. Para crear dicho archivo haz lo siguiente:</span></p><ul><li><span>Abre Rstudio</span></li><li><span>Dale al botón archivo y crear nuevo archivo de R.</span></li><li><span>Guarda el archivo de R en tu directorio de trabajo.</span></li><li><span>Ve copiando lo que va apareciendo a continuación.</span></li></ul></li><li><p><span>(1) Primero establecemos el directorio de trabajo. Sustituye lo que hay entre comillas por tu ruta. Para acceder a la ruta, usa tu explorador de archivos, ponte sobre la barra de navegación, botón derecho y copiar ruta en modo texto. </span></p></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="{r setup, include=FALSE}"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="{r setup, include=false}"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Definimos directorio de trabajo y cargamos los paquetes necesarios</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">setwd</span>(<span class="cm-string">"/Users/fjbonet_trabajo/Downloads/ndvi"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">#Instalar y cargar los paquetes necesarios.</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"Kendall"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"rgdal"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">install.packages</span>(<span class="cm-string">"raster"</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">raster</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">rgdal</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">library</span>(<span class="cm-variable">Kendall</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 264px;"></div><div class="CodeMirror-gutters" style="display: none; height: 264px;"></div></div></div></pre><ul><li><p><span>(2) Crea una </span><em><span>pila</span></em><span> de archivos que contiene todos los archivos con extensión </span><em><span>.tiff</span></em><span> que estén en tu carpeta de trabajo. Create</span><strong><span>*</span></strong><span> a stack containing all </span><em><span>.tiff</span></em><span> files created by GEE.</span></p><ul><li><span>Primero creamos una lista con los nombres de todos los archivos con extensión </span><em><span>tif</span></em><span> que hay en tu carpeta de trabajo. Ten cuidado porque si has cargado antes los archivos .tif en QGIS es posible que se hayan creado otros archivos con extensión </span><em><span>.tif.xml</span></em><span>. Estos archivos también serán seleccionados por la función </span><em><span>list.files</span></em><span> que se describe más abajo. Borra o mueve todos los archivos con tiff en el nombre que no sean los que corresponden a las imágenes de NDVI máximo anual. </span></li><li><span>Luego usamos la función </span><em><span>slack</span></em><span> para crear una pila de archivos con los tif anteriores. Se crea un tipo de objeto llamado </span><a href='https://www.rdocumentation.org/packages/raster/versions/3.0-12/topics/stack'><em><span>RasterStack</span></em></a><span>. Es una colección de capas raster que tienen la misma extensión y resolución espacial. </span></li><li><span>Después, usamos la función  </span><em><span>Brick</span></em><span>. Un </span><a href='https://www.rdocumentation.org/packages/raster/versions/2.9-23/topics/brick'><span>Brick</span></a><span> es una capa multibanda. Es similar al </span><em><span>stack</span></em><span> anterior, pero se procesa más rápidamente en la memoria. </span></li><li><span>La función </span><em><span>plot</span></em><span> permite representar gráficamente cada una de las bandas contenidas en el objeto creado anteriormente. </span></li><li><span>Finalmente exportamos el archivo resultante a una imagen </span><em><span>.tif</span></em><span>. Usaremos esta imagen multibanda para crear gráficas de las series temporales de NDVI de cada punto en QGIS. </span></li></ul></li></ul><p><span> </span></p><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="r"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Empaquetamos todas las imagenes tiff generadas por GEE en una unica imagen multibanda</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lista_imagenes</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">list.files</span>(<span class="cm-variable">pattern</span><span class="cm-operator">=</span><span class="cm-string">'*.tif'</span>, <span class="cm-variable">full.names</span><span class="cm-operator">=</span><span class="cm-variable">TRUE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ndvis</span> <span class="cm-operator cm-arrow">&lt;-</span> <span class="cm-variable">brick</span>(<span class="cm-variable">stack</span>(<span class="cm-variable">lista_imagenes</span>))</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">plot</span>(<span class="cm-variable">ndvis</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Exportamos la imagen a tif</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">writeRaster</span>(<span class="cm-variable">ndvis</span>, <span class="cm-variable">filename</span><span class="cm-operator">=</span><span class="cm-string">"ndvi_1999_2018.tif"</span>, <span class="cm-variable">format</span><span class="cm-operator">=</span><span class="cm-string">"GTiff"</span>, <span class="cm-variable">overwrite</span><span class="cm-operator">=</span><span class="cm-variable">TRUE</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 198px;"></div></div></div></pre><ul><li><p><span>(3) Ejecutamos un test estadístico llamado </span><a href='https://www.statisticshowto.datasciencecentral.com/mann-kendall-trend-test/'><span>Mann Kendall</span></a><span> sobre todas las bandas del objeto multicapa creado anteriormente. Este test permite analizar la evolución temporal de una serie de datos identificando si la tendencia es ascentente o descendente. Es un test no paramétrico, así que puede usarse en todas las distribuciones de datos.  </span></p><ul><li><p><span>&quot;Encapsulamos&quot; el test estadístico  </span><a href='https://www.rdocumentation.org/packages/Kendall/versions/2.2/topics/MannKendall'><span>Mann Kendall</span></a><span> en una funciónde R </span><em><span>fun_k</span></em><span>.</span></p></li><li><p><span>Luego creamos un nuevo objeto llamado  </span><em><span>kendal_result</span></em><span> que contiene el resultado de aplicar la función Kendall al conjunto de datos (</span><em><span>ndvis</span></em><span>).</span></p></li><li><p><span>El resultado es otro objeto espacial que contiene cinco bandas. Solo prestaremos atención a las siguientes:</span></p><ul><li><em><span>tau</span></em><span>= Es el estadístico </span><em><span>tau</span></em><span> del test de Kendall. Contiene la tendencia que el test ha identificado en cada elemento de la serie. Los valores negativos indican que la tendencia es descentente y ascendente si son positivos. Es decir, valores positivos indican que hay una tendencia hacia más NDVI en el pixel en cuestión. </span></li><li><em><span>sl</span></em><span>= Es el p-valor del test. Muesta el valor de significación del test en cada píxel.  </span></li></ul></li><li><p><span>Finalmente exportamos la banda </span><em><span>tau</span></em><span> a una imagen llamada </span><em><span>tau.tif</span></em><span>.</span></p></li></ul></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="r"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="r"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">## Calculamos la serie temporal de todos los pixeles</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">fun_k</span> <span class="cm-operator cm-arrow">&lt;-</span><span class="cm-keyword">function</span>(<span class="cm-variable">x</span>){<span class="cm-builtin">return</span>(<span class="cm-variable">unlist</span>(<span class="cm-variable">MannKendall</span>(<span class="cm-variable">x</span>)))}</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">kendal_result</span> <span class="cm-operator cm-arrow">&lt;-</span><span class="cm-variable">calc</span>(<span class="cm-variable">ndvis</span>, <span class="cm-variable">fun_k</span>)</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Exportamos la tendencia (tau) a un tif</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">writeRaster</span>(<span class="cm-variable">kendal_result</span><span class="cm-operator cm-dollar">$</span><span class="cm-variable">tau</span>, <span class="cm-variable">filename</span><span class="cm-operator">=</span><span class="cm-string">"tau.tif"</span>, <span class="cm-variable">format</span><span class="cm-operator">=</span><span class="cm-string">"GTiff"</span>, <span class="cm-variable">overwrite</span><span class="cm-operator">=</span><span class="cm-variable">TRUE</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 154px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></pre><ul><li><p><span>(4) Cargamos toda la información en QGIS. Para visualizar la información que hemos generado, procedemos de la siguiente manera.</span></p><ul><li><p><span>Abrimos un proyecto de QGIS nuevo.</span></p></li><li><p><span>En el menú capa seleccionamos la opción de cargar capa raster. Navegamos a la carpeta donde esté la información y seleccionamos las siguientes capas:</span></p><ul><li><strong><span>ndvi_1999_2018.tif</span></strong><span>: Contiene una banda por año. Y cada banda muestra el valor máximo de NDVI de ese año. Usaremos esta capa para construir automáticamente gráficas con las series temporales de cada píxel.</span></li><li><strong><span>tau.tif</span></strong><span>: Contiene los valores de tendencias de NDVI para cada píxel. Una vez cargada hacemos doble click sobre la misma y la representamos usando el método de </span><em><span>singleband pseudocolor</span></em><span> y la paleta </span><em><span>spectral</span></em><span>. Ajusta el valor máximo a 0.99 y haz click en &quot;elimina valores fuera de rango&quot;. Por último, le asignamos un grado de transparencia del 50%.</span></li><li><strong><span>ortofoto reciente</span></strong><span>: Cargamos o creamos (Según lo tengas creado o no) un servicio WMS con la ortofotografía más reciente. Si tienes que crearlo, la URL de este servicio es: </span><a href='http://www.ign.es/wms-inspire/pnoa-ma' target='_blank' class='url'>http://www.ign.es/wms-inspire/pnoa-ma</a></li></ul></li></ul></li></ul><ul><li><p><span>(5) Vamos a construir un gráfico que muestra la tendencia de NDVI para cualquier píxel de la zona de estudio. Sigue estos pasos para ello:</span></p><ul><li><span>Instala un plugin llamado  &quot;</span><em><span>Temporal/Spectral profile tool</span></em><span>&quot;. Menu </span><em><span>plugins</span></em><span>-&gt;</span><em><span>Manage and install plugins</span></em><span>. La instalación creará un nuevo botón que representa un gráfico rojo. </span></li><li><span>Selecciona la capa &quot;</span><em><span>ndvi_1999_2020</span></em><span>&quot; en QGIS.</span></li><li><span>Haz click en el botón del plugin que acabas de instalar.</span></li><li><span>Haz click en la pestaña </span><em><span>settings</span></em><span> que sale abajo y selecciona la opción &quot;Time&quot; del desplegable que hay bajo &quot;X-axis steps&quot;. Vamos a hacer que en el eje X de la gráfica aparezcan los años. Pon 1999 en el año de inicio (Time frame start). Luego cambia en el desplegable el &quot;time size frame&quot; y selecciona &quot;year&quot;.</span></li><li><span>Haz click en cualquier punto del mapa para que se muestre una imagen como la que ves a continuación. </span></li></ul></li></ul><p>&nbsp;</p><p><img src="https://github.com/aprendiendo-cosas/P_NDVI_UCO_ecologia_II/raw/main/imagenes/graph.png" referrerpolicy="no-referrer" alt="graph"></p><p>&nbsp;</p><h3><a name="cálculo-del-ndvi-promedio" class="md-header-anchor"></a><span>Cálculo del NDVI promedio.</span></h3><p><span>Esta parte de la práctica tiene una componente experimental. Planteamos la hipótesis de que el valor promedio de los máximos anuales de NDVI es un buen subrogado de la densidad de la vegetación. Se dice que una variable es subrogada de otra cuando la primera explica bien la segunda. Es decir, están correlacionadas. Por ejemplo, cuando subimos una montaña suele bajar la temperatura. Por eso se dice que la altitud es un buen subrogado de la temperatura. Como es más fácil medir la altitud que la temperatura, a veces se usa la segunda para caracterizar la distribución espacial de la primera. En nuestro caso queremos comprobar si el NDVI es un buen subrogado de la densidad del bosque.</span></p><p><span>Para contrastar nuestra hipótesis nos valdremos de los datos de densidad real tomados en el Patriarca durante la salida de campo. En dicha salida tomamos datos de densidad de varios puntos. En esos puntos tenemos también datos de NDVI, dado que esta información ocupa todo el territorio. Por tanto podemos comparar los valores de densidad real y NDVI de cada punto de muestreo de campo. Y veremos si hay una correlación matemática. Si la hay, podremos decir que, en efecto, el NDVI es un buen subrogado de la densidad. </span></p><p><span>Con objeto de testar esta hipótesis haremos lo siguiente:</span></p><ul><li><span>(1) Cargamos todas las imágenes con el NDVI máximo anual en QGIS. Para cargar las imágenes, abrimos un proyecto nuevo. Luego, desde el explorador de archivos arrastramos todas las imágenes con extensión </span><em><span>.tif</span></em><span> a la tabla de contenidos de QGIS. Esto hará que aparezcan listadas todas las capas. No necesitamos que se vean con colores.</span></li><li><span>(2) En el menú raster, seleccionamos el &quot;Raster calculator&quot;. Aparecerán todas las imágenes descritas así: </span><em><span>1999@1</span></em><span>. Esto indica que es la banda 1 de la imagen llamada 1999. Vamos a calcular el promedio de las 20 imágenes existentes según puedes ver a continuación. También has de indicar el nombre de la capa de salida, que será </span><em><span>promedio_ndvi.tif</span></em><span>. Asegúrate de seleccionar la carpeta donde estás guardando toda la información.</span></li></ul><pre spellcheck="false" class="md-fences md-end-block ty-contain-cm modeLoaded" lang="python"><div class="CodeMirror cm-s-inner CodeMirror-wrap" lang="python"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">(<span class="cm-string">"1999@1"</span><span class="cm-operator">+</span><span class="cm-string">"2000@1"</span><span class="cm-operator">+</span><span class="cm-string">"2001@1"</span><span class="cm-operator">+</span><span class="cm-string">"2002@1"</span><span class="cm-operator">+</span><span class="cm-string">"2003@1"</span><span class="cm-operator">+</span><span class="cm-string">"2004@1"</span><span class="cm-operator">+</span><span class="cm-string">"2005@1"</span><span class="cm-operator">+</span><span class="cm-string">"2006@1"</span><span class="cm-operator">+</span><span class="cm-string">"2007@1"</span><span class="cm-operator">+</span><span class="cm-string">"2008@1"</span><span class="cm-operator">+</span><span class="cm-string">"2009@1"</span><span class="cm-operator">+</span><span class="cm-string">"2010@1"</span><span class="cm-operator">+</span><span class="cm-string">"2011@1"</span><span class="cm-operator">+</span><span class="cm-string">"2012@1"</span><span class="cm-operator">+</span><span class="cm-string">"2013@1"</span><span class="cm-operator">+</span><span class="cm-string">"2014@1"</span><span class="cm-operator">+</span><span class="cm-string">"2015@1"</span><span class="cm-operator">+</span><span class="cm-string">"2016@1"</span><span class="cm-operator">+</span><span class="cm-string">"2017@1"</span><span class="cm-operator">+</span><span class="cm-string">"2018@1"</span>)<span class="cm-operator">/</span><span class="cm-number">20</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 44px;"></div><div class="CodeMirror-gutters" style="display: none; height: 44px;"></div></div></div></pre><ul><li><span>(3) Acabado el cálculo, se cargará la imagen automáticamente. Una vez que esto ocurra, represéntala con la paleta de colores &quot;greens&quot;. Como siempre: doble click sobre la capa, pestaña de estilo o simbología (dependiendo de tu versión de QGIS), &quot;single band pseudocolor&quot;. Ponla también algo transparente (50%) para que se vea la ortofoto de fondo.</span></li><li><span>(4) Ahora puedes observar por tí mismo si hay cierta correlación visual entre la densidad que ves en la ortofoto y la que indica el NDVI. Lo que haremos a continuación es cuantificar ese nivel de correlación. Para ello construiremos una gráfica de dispersión que relacione, para cada punto de muestreo de campo, los valores de densidad con el NDVI. Pero para hacer esto necesitamos los datos de campo, así que no lo haremos en esta práctica. </span></li></ul><p>&nbsp;</p><p>&nbsp;</p><h2><a name="ejercicio" class="md-header-anchor"></a><span>Ejercicio</span></h2><p><span>Para evaluar en qué medida has entendido tanto la parte ecológica de esta práctica como las competencias de manejo de herramientas, deberás completar el siguiente ejercicio. </span></p><p><span>Usando las imágenes creadas durante la práctica, tienes que encontrar un punto en la zona de estudio amplia (Patriarca +  Sierra) en la que haya una tendencia negativa o positiva en el  funcionamiento de la vegetación y que dicho comportamiento pueda interpretarse  a través de cambios en la estructura de la  vegetación. Es decir, que la tendencia de NDVI se corresponda con  alteraciones estructurales en el ecosistema que puedas identificar  mediante las distintas ortofotos. Ej. Tendencia de NDVI negativa en  lugares donde en alguna ortofoto se vean síntomas de un incendio  forestal. Para hacer esto deberá de cargar, además de los resultados de la práctica, una serie de ortofotos con fechas desde 1999 hasta 2018. Estas ortofotos te ayudarán a comprender si los cambios que observas en el NDVI (funcionamiento ecosistémico) se corresponden o no con cambios estructurales en la vegetación (ej. incencios, reforestaciones ,etc.). </span><a href='http://www.juntadeandalucia.es/medioambiente/site/rediam/menuitem.aedc2250f6db83cf8ca78ca731525ea0/?vgnextoid=867122ad8470f210VgnVCM1000001325e50aRCRD&amp;lr=lang_es'><span>Aquí</span></a><span> tienes una lista de las ortofotografías disponibles en Andalucía.</span></p><p><span>Tienes que entregar un documento de word o libre office con lo siguiente:</span></p><ul><li><span>Captura de pantalla en la que se vea el punto que has seleccionado, con una ortofoto de fondo y con la capa de tendencia de NDVI (</span><em><span>tau.tif</span></em><span>).</span></li><li><span>Gráfica de la serie temporal en ese punto. Para ello usa el plugin de QGIS descrito más arriba. </span></li><li><span>Breve texto que explique la situación que has interpretado. Por ejemplo: en esta zona se observa una fuerte tendencia al crecimiento de la vegetación desde 2000. Eso se observa también en las ortofotos de la época. Creo que se debe a que la zona está recién reforestada.</span></li><li><span>Extra: Si además identificas algún otro lugar (y lo describes) en el que haya mucho NDVI (valores del promedio de NDVI altos) y tendencias descendentes (decaimiento forestal) tendrás mejor calificación.</span></li></ul><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p></div>
</body>
</html>